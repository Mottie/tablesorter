(function(factory){if (typeof define === 'function' && define.amd){define(['jquery'], factory);} else if (typeof module === 'object' && typeof module.exports === 'object'){module.exports = factory(require('jquery'));} else {factory(jQuery);}}(function(jQuery){

/*! Dragtable Mod for TableSorter - updated 10/31/2015 (v2.24.0) */
!function(v){"use strict";var u=v.tablesorter;u.dragtable={create:function(t){var a,e=t.originalTable.el,r=t.options.dragHandle.replace(".","");e.children("thead").children().children("th,td").each(function(){var e=v(this);e.find(t.options.dragHandle+",."+r+"-disabled").length||(a=!t.options.dragaccept||e.hasClass(t.options.dragaccept.replace(".","")),e.wrapInner('<div class="'+t.options.sortClass.replace(".","")+'"/>').prepend('<div class="'+r+(a?"":"-disabled")+'"></div>'))})},start:function(e){(e=v(e)[0])&&e.config&&(e.config.widgetOptions.dragtableLast={search:v(e).data("lastSearch"),order:u.dragtable.getOrder(e)})},update:function(e){var a,r,t=e.originalTable,i=t.el[0],n=v(i),o=i.config,l=o&&o.widgetOptions,s=t.startIndex-1,t=t.endIndex-1,d=u.dragtable.getOrder(i)||[],c=u.hasWidget(n,"filter")||!1,h=l&&l.dragtableLast||{},b=[];(h.order||[]).join("")!==d.join("")&&(o.sortList.length&&(a=v.extend(!0,[],o.sortList),v.each(d,function(e,t){r=u.isValueInArray(parseInt(t,10),a),t!==h.order[e]&&0<=r&&(o.sortList[r][0]=e)})),c&&v.each(h.search||[],function(e){b[e]=h.search[d[e]]}),(i=!!u.hasWidget(o.$table,"editable")&&l.editable_columnsArray)&&(o.widgetOptions.editable_columnsArray=u.dragtable.reindexArrayItem(i,s,t)),(i=!!u.hasWidget(o.$table,"math")&&l.math_ignore)&&(o.widgetOptions.math_ignore=u.dragtable.reindexArrayItem(i,s,t)),(i=!!u.hasWidget(o.$table,"resizable")&&l.resizable_widths)&&(l.resizable_widths=u.dragtable.moveArrayItem(i,s,t)),u.updateAll(o,!1,function(){c&&setTimeout(function(){o.lastCombinedFilter=null,o.$table.data("lastSearch",b),u.setFilters(n,b),"function"==typeof e.options.tablesorterComplete&&e.options.tablesorterComplete(o.table)},10)}))},getOrder:function(e){return v(e).children("thead").children("."+u.css.headerRow).children().map(function(){return v(this).attr("data-column")}).get()||[]},startColumnMove:function(e){var t,a=e.el[0].config,r=e.startIndex-1,i=e.endIndex-1,e=a.columns-1,n=i!=e&&i<=r,e=a.$table.children().children("tr");a.debug&&console.log("Inserting column "+r+(n?" before":" after")+" column "+i),e.each(function(){(t=v(this).children()).eq(r)[n?"insertBefore":"insertAfter"](t.eq(i))}),(t=a.$table.children("colgroup").children()).eq(r)[n?"insertBefore":"insertAfter"](t.eq(i))},swapNodes:function(e,t){for(var a,r,i=e.length,n=0;n<i;n++)a=e[n].parentNode,r=e[n].nextSibling===t[n]?e[n]:e[n].nextSibling,t[n].parentNode.insertBefore(e[n],t[n]),a.insertBefore(t[n],r)},moveArrayItem:function(e,t,a){var r,i=e.length;if(i<=a)for(r=a-i;1+r--;)e.push(void 0);return e.splice(a,0,e.splice(t,1)[0]),e},reindexArrayItem:function(e,a,r){var t=v.inArray(r,e),i=v.inArray(a,e),n=(Math.max.apply(Math,e),[]);return 0<=t&&0<=i?e:(v.each(e,function(e,t){r<a?r<=t?n.push(t+(t<a?1:0)):n.push(t):a<r&&(t===a?n.push(r):t<r&&a<=t?n.push(t-1):t<=r?n.push(t):a<t&&n.push(t+(t<r?0:1)))}),n.sort())}},
/*! dragtable v2.0.14 Mod */
v.widget("akottr.dragtable",{options:{revert:!1,dragHandle:".table-handle",maxMovingRows:40,excludeFooter:!1,onlyHeaderThreshold:100,dragaccept:null,persistState:null,restoreState:null,exact:!0,clickDelay:10,containment:null,cursor:"move",cursorAt:!1,distance:0,tolerance:"pointer",axis:"x",beforeStart:v.noop,beforeMoving:v.noop,beforeReorganize:v.noop,beforeStop:v.noop,tablesorterComplete:null,sortClass:".sorter"},originalTable:{el:null,selectedHandle:null,sortOrder:null,startIndex:0,endIndex:0},sortableTable:{el:v(),selectedHandle:v(),movingRow:v()},persistState:function(){var t=this;this.originalTable.el.find("th").each(function(e){""!==this.id&&(t.originalTable.sortOrder[this.id]=e)}),v.ajax({url:this.options.persistState,data:this.originalTable.sortOrder})},_restoreState:function(e){for(var t in e)t in e&&(this.originalTable.startIndex=v("#"+t).closest("th").prevAll().length+1,this.originalTable.endIndex=parseInt(e[t],10)+1,this._bubbleCols())},_bubbleCols:function(){u.dragtable.startColumnMove(this.originalTable)},_rearrangeTableBackroundProcessing:function(){var e=this;return function(){e._bubbleCols(),e.options.beforeStop(e.originalTable),e.sortableTable.el.remove(),function(){v("#__dragtable_disable_text_selection__").remove(),t?v(document.body).attr("onselectstart",t):v(document.body).removeAttr("onselectstart");a?v(document.body).attr("unselectable",a):v(document.body).removeAttr("unselectable")}(),u.dragtable.update(e),"function"==typeof e.options.persistState?e.options.persistState(e.originalTable):e.persistState()}},_rearrangeTable:function(){var e=this;return function(){e.originalTable.selectedHandle.removeClass("dragtable-handle-selected"),e.sortableTable.el.sortable("disable"),e.sortableTable.el.addClass("dragtable-disabled"),e.options.beforeReorganize(e.originalTable,e.sortableTable),e.originalTable.endIndex=e.sortableTable.movingRow.prevAll().length+1,setTimeout(e._rearrangeTableBackroundProcessing(),50)}},_generateSortable:function(e){e.cancelBubble?e.cancelBubble=!0:e.stopPropagation();for(var t=this,a=this.originalTable.el[0].attributes,r="",i=0;i<a.length;i++)(a[i].value||a[i].nodeValue)&&"id"!=a[i].nodeName&&"width"!=a[i].nodeName&&(r+=a[i].nodeName+'="'+(a[i].value||a[i].nodeValue)+'" ');var n=[],o=[];t.originalTable.el.children("thead, tbody").children("tr:visible").slice(0,t.options.maxMovingRow).each(function(){for(var e=this.attributes,t="",a=0;a<e.length;a++)(e[a].value||e[a].nodeValue)&&"id"!=e[a].nodeName&&(t+=" "+e[a].nodeName+'="'+(e[a].value||e[a].nodeValue)+'"');n.push(t),o.push(v(this).height())});var l=[],s=0,d=t.originalTable.el.children(),c=d.filter("thead").children("tr:visible"),h=d.filter("tbody").children("tr:visible");c.eq(0).children("th, td").filter(":visible").each(function(){var e=v(this).outerWidth();l.push(e),s+=e}),t.options.exact&&(g=s-t.originalTable.el.outerWidth(),l[0]-=g),s+=2;var b=0;d.filter("caption").each(function(){b+=v(this).outerHeight()});for(var u,g='<ul class="dragtable-sortable" style="position:absolute; width:'+s+'px;">',p=[],f=c.eq(0).children("th, td").length,i=0;i<f;i++){var m=c.children(":nth-child("+(i+1)+")");m.is(":visible")&&(u=0,p[i]='<li style="width:'+m.outerWidth()+'px;"><table '+r+">"+(b?'<caption style="height:'+b+'px;"></caption>':"")+"<thead>",c.each(function(e){p[i]+="<tr "+n[u++]+(o[e]?' style="height:'+o[e]+'px;"':"")+">"+m[e].outerHTML+"</tr>"}),p[i]+="</thead><tbody>",m=h.children(":nth-child("+(i+1)+")"),(m=1<t.options.maxMovingRows?m.add(h.children(":nth-child("+(i+1)+")").slice(0,t.options.maxMovingRows-1)):m).each(function(e){p[i]+="<tr "+n[u++]+(o[e]?' style="height:'+o[e]+'px;"':"")+">"+this.outerHTML+"</tr>"}),p[i]+="</tbody>",t.options.excludeFooter||(p[i]+="<tfoot><tr "+n[u++]+">"+d.filter("tfoot").children("tr:visible").children()[i].outerHTML+"</tr></tfoot>"),p[i]+="</table></li>")}g+=p.join("")+"</ul>",this.sortableTable.el=this.originalTable.el.before(g).prev(),this.sortableTable.el.find("> li > table").each(function(e){v(this).css("width",l[e]+"px")}),this.sortableTable.selectedHandle=this.sortableTable.el.find("th .dragtable-handle-selected");g=this.options.dragaccept?"li:has("+this.options.dragaccept+")":"li";this.sortableTable.el.sortable({items:g,stop:this._rearrangeTable(),revert:this.options.revert,tolerance:this.options.tolerance,containment:this.options.containment,cursor:this.options.cursor,cursorAt:this.options.cursorAt,distance:this.options.distance,axis:this.options.axis}),this.originalTable.startIndex=v(e.target).closest("th,td").prevAll().length+1,this.options.beforeMoving(this.originalTable,this.sortableTable),this.sortableTable.movingRow=this.sortableTable.el.children("li:nth-child("+this.originalTable.startIndex+")"),g=v('<style id="__dragtable_disable_text_selection__" type="text/css">body { -ms-user-select:none;-moz-user-select:-moz-none;-khtml-user-select:none;-webkit-user-select:none;user-select:none; }</style>'),v(document.head).append(g),v(document.body).attr("onselectstart","return false;").attr("unselectable","on"),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),this.sortableTable.movingRow.trigger(v.extend(v.Event(e.type),{which:1,clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY}));e=this.sortableTable.el.find(".ui-sortable-placeholder");0<e.height()&&e.css("height",this.sortableTable.el.find(".ui-sortable-helper").height()),e.html('<div class="outer" style="height:100%;"><div class="inner" style="height:100%;"></div></div>')},bindTo:{},_create:function(){var t=this;t.originalTable={el:t.element,selectedHandle:v(),sortOrder:{},startIndex:0,endIndex:0},u.dragtable.create(t),t.bindTo="> thead > tr > "+(t.options.dragaccept||"th, td"),t.element.find(t.bindTo).find(t.options.dragHandle).length&&(t.bindTo+=" "+t.options.dragHandle),"function"==typeof t.options.restoreState?t.options.restoreState(t.originalTable):t._restoreState(t.options.restoreState),t.originalTable.el.on("mousedown.dragtable",t.bindTo,function(e){1===e.which&&(u.dragtable.start(t.originalTable.el),!1!==t.options.beforeStart(t.originalTable)&&(clearTimeout(t.downTimer),t.downTimer=setTimeout(function(){t.originalTable.selectedHandle=v(t),t.originalTable.selectedHandle.addClass("dragtable-handle-selected"),t._generateSortable(e)},t.options.clickDelay)))}).on("mouseup.dragtable",t.options.dragHandle,function(){clearTimeout(t.downTimer)})},redraw:function(){this.destroy(),this._create()},destroy:function(){this.originalTable.el.off("mousedown.dragtable mouseup.dragtable",this.bindTo),v.Widget.prototype.destroy.apply(this,arguments)}});var t=v(document.body).attr("onselectstart"),a=v(document.body).attr("unselectable")}(jQuery);return jQuery;}));
