(function(factory){if (typeof define === 'function' && define.amd){define(['jquery'], factory);} else if (typeof module === 'object' && typeof module.exports === 'object'){module.exports = factory(require('jquery'));} else {factory(jQuery);}}(function(jQuery){

!function(l){"use strict";var i,a,o,n=l.tablesorter,r=!1,c=n.view={copyCaption:function(e,t){c.removeCaption(e,t),0<e.$table.find("caption").length&&l(t.view_caption).text(e.$table.find("caption").text())},removeCaption:function(e,t){l(t.view_caption).empty()},buildToolBar:function(t,a){c.removeToolBar(t,a),c.copyCaption(t,a);var o=l(a.view_toolbar);l.each(a.view_layouts,function(e,t){var i=a.view_switcher_class;e===a.view_layout&&(i+=" active");e=l("<a>",{href:"#","class":i,"data-view-type":e,title:t.title});e.append(l("<i>",{"class":t.icon})),o.append(e)}),o.find("."+a.view_switcher_class).on("click",function(e){return e.preventDefault(),!l(this).hasClass("active")&&(o.find("."+a.view_switcher_class).removeClass("active"),l(this).addClass("active"),a.view_layout=l(this).attr("data-view-type"),void(!0===a.view_layouts[a.view_layout].raw?(c.remove(t,a),c.buildToolBar(t,a)):(!1===r&&c.hideTable(t,a),c.buildView(t,a))))})},removeToolBar:function(e,t){l(t.view_toolbar).empty(),c.removeCaption(e,t)},buildView:function(e,t){c.removeView(e,t);var a=t.view_layouts[t.view_layout],o=l(a.container,{"class":t.view_layout});n.getColumnText(e.$table,0,function(e){var n=a.tmpl;l.each(l(e.$row).find("td"),function(e,t){var i={},a="{col"+e+"}";l.each(t.attributes,function(e,t){i[t.nodeName]=t.nodeValue});var o=l(t).html(),o=l("<span />").append(l("<span/>",i).append(o));n=n.replace(new RegExp(a,"g"),o.html()),a="{col"+e+":raw}",n=n.replace(new RegExp(a,"g"),l(t).text())});var i=l(n);l.each(e.$row[0].attributes,function(e,t){"class"===t.nodeName?i.attr(t.nodeName,i.attr(t.nodeName)+" "+t.nodeValue):i.attr(t.nodeName,t.nodeValue)}),o.append(i)}),l(t.view_container).append(o),e.$table.triggerHandler("viewComplete")},removeView:function(e,t){l(t.view_container).empty()},hideTable:function(e){i=e.$table.css("position"),a=e.$table.css("bottom"),o=e.$table.css("left"),e.$table.css({position:"absolute",top:"-10000px",left:"-10000px"}),r=!0},init:function(e,t){!1!==t.view_layout&&void 0!==t.view_layouts[t.view_layout]&&(!1===r&&c.hideTable(e,t),e.$table.on("tablesorter-ready",function(){c.buildToolBar(e,t),c.buildView(e,t)}))},remove:function(e,t){c.removeToolBar(e,t),c.removeView(e,t),e.$table.css({position:i,top:a,left:o}),r=!1}};n.addWidget({id:"view",options:{view_toolbar:"#ts-view-toolbar",view_container:"#ts-view",view_caption:"#ts-view-caption",view_switcher_class:"ts-view-switcher",view_layout:!1,view_layouts:{}},init:function(e,t,i,a){c.init(i,a)},remove:function(e,t,i){c.remove(t,i)}})}(jQuery);return jQuery;}));
